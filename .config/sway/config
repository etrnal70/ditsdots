# Sway Config

# Defaults
## Key Modifier
set $mod Mod4

## Home row direction keys
set $left h
set $down j
set $up k
set $right l

## Terminal Emulator
set $term kitty

## Wallpaper
output * bg ~/Data/wallpaper/cell.gif fill

# Input Configuration
## Touch Screen (Map only to touchscreen area)
input "type:touch" map_to_output eDP-1

## Touchpad
input "type:touchpad" {
    drag enabled
    dwt enabled
    tap enabled
    natural_scroll enabled
    middle_emulation enabled
}

## Keyboard
input "type:keyboard" {
  ### Double shift to CapsLock
  ### Use capslock as escape
  xkb_options shift:both_capslock_cancel,caps:escape

  ### Faster key input
  repeat_rate 50
  repeat_delay 350
}

# Seat Configuration
## Hide cursor while typing
seat * hide_cursor when-typing enable

# Key Bindings
## Mandatory Keybinds
### Start a terminal
bindsym $mod+Return exec $term

### Kill focused window
bindsym $mod+q kill

### Start default launcher
bindsym --release Super_L exec (pgrep "wofi" 1>/dev/null 2>&1 && killall wofi) || wofi -a --show=drun
bindsym --release Super_R exec (pgrep "wofi" 1>/dev/null 2>&1 && killall wofi) || wofi -a --show=drun

### Floating Modifier
floating_modifier $mod normal

### Reload sway
bindsym $mod+Shift+c reload

### Exit sway
bindsym $mod+Shift+e exec swaynag -t warning -m 'You pressed the exit shortcut. Do you really want to exit sway? This will end your Wayland session.' -b 'Yes, exit sway' 'swaymsg exit'

## App-specific Keybinds
### Scripts Launcher
bindsym $mod+period exec ~/.scripts/dmenu_toggle.sh

### Execute Command
bindsym $mod+comma exec (pgrep "rofi" 1>/dev/null 2>&1 && killall rofi) || rofi -show run

### Dunst
bindsym $mod+backslash exec ~/.scripts/dnd_toggle.sh

## Movement Keybinds
### Move your focus around
bindsym $mod+$left focus left
bindsym $mod+$down focus down
bindsym $mod+$up focus up
bindsym $mod+$right focus right
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

### Move the focused window with the same, but add Shift
bindsym $mod+Shift+$left move left
bindsym $mod+Shift+$down move down
bindsym $mod+Shift+$up move up
bindsym $mod+Shift+$right move right
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

## Workspaces Keybinds
### Switch to workspace
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

### Move current workspace to output
bindsym $mod+Control+Shift+$up move workspace to output up
bindsym $mod+Control+Shift+$right move workspace to output right
bindsym $mod+Control+Shift+$left move workspace to output left
bindsym $mod+Control+Shift+$down move workspace to output down

### Move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number 1
bindsym $mod+Shift+2 move container to workspace number 2
bindsym $mod+Shift+3 move container to workspace number 3
bindsym $mod+Shift+4 move container to workspace number 4
bindsym $mod+Shift+5 move container to workspace number 5
bindsym $mod+Shift+6 move container to workspace number 6
bindsym $mod+Shift+7 move container to workspace number 7
bindsym $mod+Shift+8 move container to workspace number 8
bindsym $mod+Shift+9 move container to workspace number 9
bindsym $mod+Shift+0 move container to workspace number 10

### Switch back and forth
bindsym Mod1+Tab workspace back_and_forth

## Layout Keybinds
### Split
bindsym $mod+b splith
bindsym $mod+v splitv

### Switch current window layout
bindsym $mod+i layout stacking
bindsym $mod+o layout tabbed
bindsym $mod+p layout toggle split

### Make the current focus fullscreen
bindsym $mod+f fullscreen

### Toggle tiling - floating window
bindsym $mod+Shift+space floating toggle

### Swap focus between the tiling area and the floating area
bindsym $mod+space focus mode_toggle

### Move focus to the parent container
bindsym $mod+a focus parent

### Scratchpad
bindsym $mod+Shift+minus move scratchpad
bindsym $mod+minus scratchpad show

## Hardware Keybinds
### Generic Hardware Button
bindsym XF86AudioRaiseVolume exec ~/.scripts/volume.sh up
bindsym XF86AudioLowerVolume exec ~/.scripts/volume.sh down
bindsym XF86AudioMute exec ~/.scripts/volume.sh mute
bindsym XF86AudioMicMute exec pactl set-source-mute @DEFAULT_SOURCE@ toggle
bindsym XF86AudioPlay exec playerctl play-pause
bindsym XF86AudioNext exec playerctl next
bindsym XF86AudioPrev exec playerctl previous
bindsym XF86MonBrightnessUp exec ~/.scripts/backlight.sh up
bindsym XF86MonBrightnessDown exec ~/.scripts/backlight.sh down

### Alternative
bindsym $mod+Mod1+7 exec playerctl previous
bindsym $mod+Mod1+8 exec playerctl play-pause
bindsym $mod+Mod1+9 exec playerctl next
bindsym $mod+Mod1+0 exec ~/.scripts/volume.sh down
bindsym $mod+Mod1+minus exec ~/.scripts/volume.sh mute
bindsym $mod+Mod1+equal exec ~/.scripts/volume.sh up

### Arrow Keys
bindsym $mod+Mod1+Left exec playerctl previous
bindsym $mod+Mod1+Right exec playerctl next
bindsym $mod+Mod1+Down exec ~/.scripts/volume.sh down
bindsym $mod+Mod1+Up exec ~/.scripts/volume.sh up

## Container Keybinds
### Resize
mode "resize_containers" {
    bindsym $left resize shrink width 10px
    bindsym $down resize grow height 10px
    bindsym $up resize shrink height 10px
    bindsym $right resize grow width 10px

    # Return to default mode
    bindsym Return mode "default"
    bindsym Escape mode "default"
}
bindsym $mod+r mode "resize_containers"

# Additional Settings
## Theme
### Window Border
default_border pixel 1
default_floating_border normal
smart_borders on

### Titlebar
titlebar_border_thickness 1
title_align center

### Gaps
gaps inner 8

### Cursor
set $my_cursor_size 30
set $my_cursor Vimix-white-cursors
seat seat0 xcursor_theme $my_cursor $my_cursor_size

### Colors
set $cl_high #FFFFFF
set $cl_indi #d9d8d8
set $cl_back #231f20
set $cl_fore #d9d8d8
set $cl_urge #ee2e24
# Properties            border   bg       text     indi     childborder
client.focused          $cl_indi $cl_back $cl_fore $cl_indi $cl_high
client.focused_inactive $cl_back $cl_back $cl_fore $cl_back $cl_back
client.unfocused        $cl_back $cl_fore $cl_back $cl_back $cl_back
client.urgent           $cl_urge $cl_urge $cl_fore $cl_urge $cl_urge

## Idle Configuration
exec swayidle -w \
         timeout 900 'swaylock -f -c 000000' \
         timeout 1200 'swaymsg "output * dpms off"' resume 'swaymsg "output * dpms on"' \
         timeout 1800 'systemctl suspend ' \
         before-sleep 'swaylock -f -c 000000 && playerctl pause'

## XWayland
xwayland enable

## Mouse
focus_follows_mouse no
mouse_warping none

## App-specific Workspaces
assign [class="Chromium"] 1
assign [class="discord"] 5
assign [app_id="firefox"] 7

## Windowing Rules
for_window {
  ### Browser
  [instance="chromium"] inhibit_idle fullscreen
  [title="MAX - Chromium"] floating enable; sticky enable; border pixel 1
  [class="firefox"] inhibit_idle fullscreen
  [class="Chromium"] inhibit_idle fullscreen
  [app_id="firefox" title="Firefox â€” Sharing Indicator"] floating enable
  [app_id="firefox" title="Library"] floating enable; border pixel 1; sticky enable
  [class="Nightly"] inhibit_idle fullscreen
  # [title = "Picture in picture"] floating enable, sticky enable

  ### Steam/WINE related
  [class="gamescope"] inhibit_idle fullscreen; floating enable; border none
  [class="steam_app.*"] inhibit_idle fullscreen; floating enable; border none
  [class=".*.exe"] inhibit_idle fullscreen; floating enable; border none
  [class="^Steam$" title="^Friends *"] floating enable
  # [class="^Steam$" title="^Friends List$"] floating enable
  [class="^Steam$" title="Steam - News"] floating enable
  [class="^Steam$" title=".* - Chat"] floating enable
  [class="^Steam$" title="^Settings$"] floating enable
  [class="^Steam$" title=".* - event started"] floating enable
  [class="^Steam$" title=".* CD key"] floating enable
  [class="^Steam$" title="^Steam - Self Updater$"] floating enable
  [class="^Steam$" title="^Screenshot Uploader$"] floating enable
  [class="^Steam$" title="^Steam Guard - Computer Authorization Required$"] floating enable
  [class="^Steam$" title="^Create or select new Steam library folcer:$"] floating enable
  [title="^Steam Keyboard$"] floating enable

  ### Desktop apps
  [app_id="zoom"] inhibit_idle fullscreen; floating enable
  [app_id="ksysguard"] floating enable; sticky enable
  [app_id="image-roll"] floating enable; border pixel 1
  [app_id="pavucontrol"] sticky enable; floating enable; resize set 720px 480px
  [app_id="wdisplays"] floating enable
  [app_id="mpv"] inhibit_idle visible; border none
  [app_id="keepassxc"] floating enable; border pixel 1; resize set 960px 870px
  [app_id="org.kde.kdeconnect.daemon"] floating enable
  [class="NoiseTorch"] floating enable; resize set 720px 580px
  [class="(\s|^)Spotify(\s|$)"] floating disable
  [class="(\s|^)WhatsApp(\s|$)"] floating disable

  ### Miscellaneous
  [title="(?:Open|Save) (?:File|Folder|As)"] floating enable; sticky enable
  [window_role = "pop-up"] floating enable
  [window_role = "bubble"] floating enable
  [window_role = "dialog"] floating enable
  [window_type = "dialog"] floating enable
  [window_role = "task_dialog"] floating enable
  [window_type = "menu"] floating enable
  [app_id = "floating"] floating enable
  [class="^.*"] inhibit_idle fullscreen
  [app_id="^.*"] inhibit_idle fullscreen
}

## Clamshell mode
### Set variable
set $laptop_screen 'eDP-1'
### Set sleep script
set $sleep sleep 3 && systemctl suspend
### Assign with lid detection
bindswitch --reload --locked lid:on exec "[$(swaymsg -t get_outputs | grep name | wc -l) == 1] && ($sleep) || (notify-send 'Clamshell Mode' 'Laptop screen off' && swaymsg output $laptop_screen disable)"
bindswitch --reload --locked lid:off output $laptop_screen enable

# Startup
## Start session target
exec "systemctl --user import-environment; systemctl --user start sway-session.target"

## Import GTK configuration
exec_always ~/.scripts/import-gsettings

###########################
include /etc/sway/config.d/*
